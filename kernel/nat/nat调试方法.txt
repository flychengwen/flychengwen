组网拓扑：
|--------------内部网络internet_aaa-------|----------内部网络internet_bbb-------------|
192.168.1.104 (vm) ------------>(192.168.1.24, 100.125.1.41) -----------> 100.125.1.65


【1】观察中间设备的包计数
enp0s8的RX packets增加
enp0s9的TX packets增加

【2】调试方法2
echo "net.netfilter.nf_conntrack_acct=1" >> /etc/sysctl.conf
yum install conntrack
conntrack -L
udp      17 29 src=192.168.1.104 dst=192.168.1.24 sport=47337 dport=8899 [UNREPLIED] src=100.125.1.65 dst=100.125.1.41 sport=8899 dport=47337 mark=0 use=1


【3】调试方法3
vi   /etc/rsyslog.conf 
#kern.warning  /var/log/iptables.log 
kern.*  /var/log/iptables.log

systemctl restart rsyslog

iptables -t nat -A PREROUTING -d 192.168.1.24 -j DNAT --to 100.125.1.65
iptables -t nat -A POSTROUTING -s 192.168.1.104 -j SNAT --to 100.125.1.41
echo 1 > /proc/sys/net/ipv4/ip_forward
iptables -t nat -nL
iptables -t nat -A PREROUTING -d 192.168.1.24 -j LOG --log-prefix 'dnat-log '
iptables -t nat -A POSTROUTING -s 192.168.1.104 -j LOG  --log-prefix 'snat-log '


[root@localhost var]# iptables -t nat -L
Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         
DNAT       all  --  anywhere             localhost.localdomain  to:100.125.1.65
LOG        all  --  anywhere             localhost.localdomain  LOG level warning prefix "dnat-log "

Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination         
SNAT       all  --  192.168.1.104        anywhere             to:100.125.1.41
LOG        all  --  192.168.1.104        anywhere             LOG level warning prefix "snat-log "
[root@localhost var]# 


